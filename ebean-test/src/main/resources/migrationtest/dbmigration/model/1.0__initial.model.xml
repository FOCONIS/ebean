<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<migration xmlns="http://ebean-orm.github.io/xml/ns/dbmigration">
    <changeSet type="apply">
        <createTable name="migtest_ckey_assoc" pkName="pk_migtest_ckey_assoc">
            <column name="id" type="integer" primaryKey="true"/>
            <column name="assoc_one" type="varchar"/>
        </createTable>
        <createTable name="migtest_ckey_detail" pkName="pk_migtest_ckey_detail">
            <column name="id" type="integer" primaryKey="true"/>
            <column name="something" type="varchar"/>
            <column name="one_key" type="integer"/>
            <column name="two_key" type="varchar(127)"/>
            <foreignKey name="fk_migtest_ckey_detail_parent" columnNames="one_key,two_key" refColumnNames="one_key,two_key" refTableName="migtest_ckey_parent" indexName="ix_migtest_ckey_detail_parent"/>
        </createTable>
        <createTable name="migtest_ckey_parent" pkName="pk_migtest_ckey_parent">
            <column name="one_key" type="integer" primaryKey="true"/>
            <column name="two_key" type="varchar(127)" primaryKey="true"/>
            <column name="name" type="varchar"/>
            <column name="assoc_id" type="integer" references="migtest_ckey_assoc.id" foreignKeyName="fk_migtest_ckey_parent_assoc_id" foreignKeyIndex="ix_migtest_ckey_parent_assoc_id"/>
            <column name="version" type="integer" notnull="true"/>
        </createTable>
        <createTable name="migtest_fk_cascade" pkName="pk_migtest_fk_cascade">
            <column name="id" type="bigint" primaryKey="true"/>
            <column name="one_id" type="bigint" references="migtest_fk_cascade_one.id" foreignKeyName="fk_migtest_fk_cascade_one_id" foreignKeyIndex="ix_migtest_fk_cascade_one_id" foreignKeyOnDelete="RESTRICT" foreignKeyOnUpdate="RESTRICT"/>
        </createTable>
        <createTable name="migtest_fk_cascade_one" pkName="pk_migtest_fk_cascade_one">
            <column name="id" type="bigint" primaryKey="true"/>
        </createTable>
        <createTable name="migtest_fk_none" pkName="pk_migtest_fk_none">
            <column name="id" type="bigint" primaryKey="true"/>
            <column name="one_id" type="bigint" references="migtest_fk_one.id" foreignKeyName="fk_migtest_fk_none_one_id" foreignKeyIndex="ix_migtest_fk_none_one_id" foreignKeyOnDelete="RESTRICT" foreignKeyOnUpdate="RESTRICT"/>
        </createTable>
        <createTable name="migtest_fk_none_via_join" pkName="pk_migtest_fk_none_via_join">
            <column name="id" type="bigint" primaryKey="true"/>
            <column name="one_id" type="bigint" references="migtest_fk_one.id" foreignKeyName="fk_migtest_fk_none_via_join_one_id" foreignKeyIndex="ix_migtest_fk_none_via_join_one_id"/>
        </createTable>
        <createTable name="migtest_fk_one" pkName="pk_migtest_fk_one">
            <column name="id" type="bigint" primaryKey="true"/>
        </createTable>
        <createTable name="migtest_fk_set_null" pkName="pk_migtest_fk_set_null">
            <column name="id" type="bigint" primaryKey="true"/>
            <column name="one_id" type="bigint" references="migtest_fk_one.id" foreignKeyName="fk_migtest_fk_set_null_one_id" foreignKeyIndex="ix_migtest_fk_set_null_one_id" foreignKeyOnDelete="RESTRICT" foreignKeyOnUpdate="RESTRICT"/>
        </createTable>
        <createTable name="migtest_e_basic" pkName="pk_migtest_e_basic">
            <column name="id" type="integer" primaryKey="true"/>
            <column name="status" type="varchar(1)" defaultValue="'A'" notnull="true" checkConstraint="check ( status in ('N','A','I','?'))" checkConstraintName="ck_migtest_e_basic_status"/>
            <column name="status2" type="varchar(127)"/>
            <column name="name" type="varchar(127)"/>
            <column name="description" type="varchar(127)" unique="uq_migtest_e_basic_description"/>
            <column name="some_date" type="timestamp"/>
            <column name="new_string_field" type="varchar" defaultValue="'foo''bar'" notnull="true"/>
            <column name="new_boolean_field" type="boolean" defaultValue="true" notnull="true">
                <after>
                    <ddl>update ${table} set ${column} = old_boolean</ddl>
                </after>
            </column>
            <column name="new_boolean_field2" type="boolean" defaultValue="true" notnull="true"/>
            <column name="indextest1" type="varchar(127)"/>
            <column name="indextest2" type="varchar(127)"/>
            <column name="indextest3" type="varchar(127)"/>
            <column name="indextest4" type="varchar(127)"/>
            <column name="indextest5" type="varchar(127)"/>
            <column name="indextest6" type="varchar(127)"/>
            <column name="progress" type="integer" defaultValue="0" notnull="true" checkConstraint="check ( progress in (0,1,2))" checkConstraintName="ck_migtest_e_basic_progress"/>
            <column name="new_integer" type="integer" defaultValue="42" notnull="true"/>
            <column name="user_id" type="integer" references="migtest_e_user.id" foreignKeyName="fk_migtest_e_basic_user_id" foreignKeyIndex="ix_migtest_e_basic_user_id"/>
            <uniqueConstraint name="uq_migtest_e_basic_status_indextest1" columnNames="status,indextest1" oneToOne="false" nullableColumns="indextest1"/>
            <uniqueConstraint name="uq_migtest_e_basic_name" columnNames="name" oneToOne="false" nullableColumns="name"/>
            <uniqueConstraint name="uq_migtest_e_basic_indextest4" columnNames="indextest4" oneToOne="false" nullableColumns="indextest4"/>
            <uniqueConstraint name="uq_migtest_e_basic_indextest5" columnNames="indextest5" oneToOne="false" nullableColumns="indextest5"/>
        </createTable>
        <createTable name="migtest_e_enum" pkName="pk_migtest_e_enum">
            <column name="id" type="integer" primaryKey="true"/>
            <column name="test_status" type="varchar(1)"/>
        </createTable>
        <createTable name="migtest_e_history" withHistory="true" pkName="pk_migtest_e_history" comment="We have history now">
            <column name="id" type="integer" primaryKey="true"/>
            <column name="test_string" type="bigint" comment="Column altered to long now"/>
        </createTable>
        <createTable name="migtest_e_history2" withHistory="true" pkName="pk_migtest_e_history2">
            <column name="id" type="integer" primaryKey="true"/>
            <column name="test_string" type="varchar" defaultValue="'unknown'" notnull="true"/>
            <column name="test_string2" type="varchar" historyExclude="true"/>
            <column name="test_string3" type="varchar" defaultValue="'unknown'" notnull="true"/>
            <column name="new_column" type="varchar(20)"/>
        </createTable>
        <createTable name="migtest_e_history3" withHistory="true" pkName="pk_migtest_e_history3">
            <column name="id" type="integer" primaryKey="true"/>
            <column name="test_string" type="varchar" historyExclude="true"/>
        </createTable>
        <createTable name="migtest_e_history4" withHistory="true" pkName="pk_migtest_e_history4">
            <column name="id" type="integer" primaryKey="true"/>
            <column name="test_number" type="bigint"/>
        </createTable>
        <createTable name="migtest_e_history5" withHistory="true" pkName="pk_migtest_e_history5">
            <column name="id" type="integer" primaryKey="true"/>
            <column name="test_number" type="integer"/>
            <column name="test_boolean" type="boolean" defaultValue="false" notnull="true"/>
        </createTable>
        <createTable name="migtest_e_history6" withHistory="true" pkName="pk_migtest_e_history6">
            <column name="id" type="integer" primaryKey="true"/>
            <column name="test_number1" type="integer" defaultValue="42" notnull="true"/>
            <column name="test_number2" type="integer"/>
        </createTable>
        <createTable name="migtest_e_softdelete" pkName="pk_migtest_e_softdelete">
            <column name="id" type="integer" primaryKey="true"/>
            <column name="test_string" type="varchar"/>
            <column name="deleted" type="boolean" defaultValue="false" notnull="true"/>
        </createTable>
        <createTable name="migtest_e_user" pkName="pk_migtest_e_user">
            <column name="id" type="integer" primaryKey="true"/>
        </createTable>
        <createTable name="migtest_mtm_c" pkName="pk_migtest_mtm_c" tablespace="TESTTS" indexTablespace="TESTTS" lobTablespace="TESTTS">
            <column name="id" type="integer" primaryKey="true"/>
            <column name="name" type="varchar"/>
        </createTable>
        <createTable name="migtest_mtm_c_migtest_mtm_m" pkName="pk_migtest_mtm_c_migtest_mtm_m" tablespace="TESTTS" indexTablespace="TESTTS" lobTablespace="TESTTS">
            <column name="migtest_mtm_c_id" type="integer" notnull="true" primaryKey="true"/>
            <column name="migtest_mtm_m_id" type="bigint" notnull="true" primaryKey="true"/>
            <foreignKey name="fk_migtest_mtm_c_migtest_mtm_m_migtest_mtm_c" columnNames="migtest_mtm_c_id" refColumnNames="id" refTableName="migtest_mtm_c" indexName="ix_migtest_mtm_c_migtest_mtm_m_migtest_mtm_c"/>
            <foreignKey name="fk_migtest_mtm_c_migtest_mtm_m_migtest_mtm_m" columnNames="migtest_mtm_m_id" refColumnNames="id" refTableName="migtest_mtm_m" indexName="ix_migtest_mtm_c_migtest_mtm_m_migtest_mtm_m"/>
        </createTable>
        <createTable name="migtest_mtm_m" pkName="pk_migtest_mtm_m" tablespace="TSMASTER" indexTablespace="TSMASTER" lobTablespace="TSMASTER">
            <column name="id" type="bigint" primaryKey="true"/>
            <column name="name" type="varchar"/>
        </createTable>
        <createTable name="migtest_mtm_m_migtest_mtm_c" pkName="pk_migtest_mtm_m_migtest_mtm_c" tablespace="TSMASTER" indexTablespace="TSMASTER" lobTablespace="TSMASTER">
            <column name="migtest_mtm_m_id" type="bigint" notnull="true" primaryKey="true"/>
            <column name="migtest_mtm_c_id" type="integer" notnull="true" primaryKey="true"/>
            <foreignKey name="fk_migtest_mtm_m_migtest_mtm_c_migtest_mtm_m" columnNames="migtest_mtm_m_id" refColumnNames="id" refTableName="migtest_mtm_m" indexName="ix_migtest_mtm_m_migtest_mtm_c_migtest_mtm_m"/>
            <foreignKey name="fk_migtest_mtm_m_migtest_mtm_c_migtest_mtm_c" columnNames="migtest_mtm_c_id" refColumnNames="id" refTableName="migtest_mtm_c" indexName="ix_migtest_mtm_m_migtest_mtm_c_migtest_mtm_c"/>
        </createTable>
        <createTable name="migtest_mtm_m_phone_numbers" pkName="pk_migtest_mtm_m_phone_numbers" tablespace="TSMASTER" indexTablespace="TSMASTER" lobTablespace="TSMASTER">
            <column name="migtest_mtm_m_id" type="bigint" notnull="true" references="migtest_mtm_m.id" foreignKeyName="fk_migtest_mtm_m_phone_numbers_migtest_mtm_m_id" foreignKeyIndex="ix_migtest_mtm_m_phone_numbers_migtest_mtm_m_id"/>
            <column name="value" type="varchar" notnull="true"/>
        </createTable>
        <createTable name="migtest_oto_child" pkName="pk_migtest_oto_child">
            <column name="id" type="integer" primaryKey="true"/>
            <column name="name" type="varchar"/>
            <column name="master_id" type="bigint" uniqueOneToOne="uq_migtest_oto_child_master_id" references="migtest_oto_master.id" foreignKeyName="fk_migtest_oto_child_master_id"/>
        </createTable>
        <createTable name="migtest_oto_master" pkName="pk_migtest_oto_master">
            <column name="id" type="bigint" primaryKey="true"/>
            <column name="name" type="varchar"/>
        </createTable>
        <createIndex indexName="ix_migtest_e_basic_indextest3" tableName="migtest_e_basic" columns="indextest3"/>
        <createIndex indexName="ix_migtest_e_basic_indextest6" tableName="migtest_e_basic" columns="indextest6"/>
        <createIndex indexName="ix_migtest_oto_child_name" tableName="migtest_oto_child" columns="name" platforms="POSTGRES"/>
    </changeSet>
</migration>